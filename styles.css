.cd-curator{ max-width:1200px; margin:0 auto; padding:24px 16px; box-sizing:border-box; }
.cd-card{ background:#fff; border:1px solid #e8e8e8; border-radius:12px; padding:16px; }

.cd-filters{ display:grid; grid-template-columns:repeat(4,minmax(0,1fr)); gap:12px; align-items:end; }
.cd-filters .row{ display:contents; }
.cd-filters label{ font-size:14px; color:#5f6368; margin-bottom:4px; display:block; }
.cd-filters select,.cd-filters input[type="date"]{ width:100%; }

.cd-kpis{ display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:12px; }
.kpi{ background:#fafafa; border:1px solid #eee; border-radius:10px; padding:12px; }
.kpi span{ font-size:18px; font-weight:600; margin-right:6px; }

.cd-tabs{ display:flex; gap:8px; margin:12px 0; }
.cd-tab{ padding:8px 12px; border-radius:8px; cursor:pointer; background:#f4f4f4; }
.cd-tab.active{ background:#e8e8ff; }

.cd-scrollx{ overflow-x:auto; }
.cd-matrix{ width:100%; border-collapse:separate; border-spacing:0; table-layout:fixed; }
.cd-matrix th,.cd-matrix td{ padding:8px 10px; border:1px solid #e5e5e5; white-space:nowrap; min-width:120px; }
.cd-matrix thead th{ position:sticky; top:0; background:#fff; z-index:3; }
.cd-matrix th:first-child,.cd-matrix td:first-child{ position:sticky; left:0; background:#fff; z-index:2; max-width:340px; }
.cd-student{ font-weight:600; }

/* Attendance density & spacing */
.cd-matrix.att { border-spacing: 2px; }
.cd-matrix.att th, .cd-matrix.att td { min-width: 64px; padding: 8px 6px; text-align:center; }
.cd-matrix.att th:first-child, .cd-matrix.att td:first-child { min-width: 260px; text-align:left; }
.cd-matrix.att.compact-1 th, .cd-matrix.att.compact-1 td { min-width: 54px; font-size: 13px; }
.cd-matrix.att.compact-2 th, .cd-matrix.att.compact-2 td { min-width: 44px; font-size: 12px; }
.cd-matrix.att.compact-3 th, .cd-matrix.att.compact-3 td { min-width: 36px; font-size: 11px; }

/* Comment indicators (subtle and non-intrusive)
   - teacher comments show a small chat glyph in the top-right
   - curator notes show a small folded-corner marker + tiny pen glyph
*/
.cd-has-comment { position: relative; }
.cd-has-comment::after{
  content: 'ðŸ’¬';
  position: absolute;
  right: 6px;
  top: 4px;
  font-size: 12px;
  line-height: 1;
  opacity: .9;
  z-index: 10001; /* ensure visibility above table cells */
  pointer-events: none;
}

/* folded-corner + small pen for curator notes */
.cd-has-cdnote { position: relative; overflow: visible; }
.cd-has-cdnote::before{
  /* tiny folded corner */
  content: '';
  position: absolute;
  top: 0;
  right: 0;
  width: 0;
  height: 0;
  border-left: 10px solid transparent;
  border-bottom: 10px solid #FFD952; /* light warm color */
  border-bottom-left-radius: 2px;
  z-index: 10001; /* ensure visibility above table cells */
  pointer-events: none;
}
.cd-has-cdnote::after{
  /* tiny pen glyph on the corner */
  content: 'âœŽ';
  position: absolute;
  right: 2px;
  top: 1px;
  font-size: 9px;
  line-height: 1;
  color: #5b4300;
  opacity: .95;
  z-index: 10002;
  pointer-events: none;
}

/* priority colors for folded corner */
.cd-prio-0::before { border-bottom-color: #FFD952; } /* normal - warm yellow */
.cd-prio-1::before { border-bottom-color: #FFD1A8; } /* important - light orange */
.cd-prio-2::before { border-bottom-color: #FF7B7B; } /* urgent - red */

/* In some table layouts pseudo-elements can be clipped; ensure cells allow visible overflow for markers */
.cd-matrix td, .cd-matrix th { overflow: visible; }

/* Inline SVG marker styles (always visible, positioned top-right) */
.cd-svg-corner, .cd-svg-pen, .cd-svg-chat { position: absolute !important; right: 0 !important; top: 0 !important; z-index: 10050 !important; pointer-events: none !important; }
.cd-svg-pen { right: 2px !important; top: 1px !important; }
.cd-svg-chat { right: 6px !important; top: 4px !important; opacity: .95 !important; }

/* wrapper for absolute markers to avoid theme clipping */
.cd-marker-abs { position: absolute !important; right: 0 !important; top: 0 !important; width: 20px !important; height: 20px !important; pointer-events: none !important; z-index: 10040 !important; display:block !important; }
.cd-marker-abs.cd-marker-chat { right: 6px !important; top: 4px !important; }

/* inline fallback marker (emoji) shown if theme hides SVGs */
.cd-inline-marker { position: absolute !important; right: 6px !important; top: 2px !important; font-size: 11px !important; color: #5b4300 !important; z-index: 10060 !important; pointer-events: none !important; opacity: .95 !important; }

/* ensure td position is relative so absolute elements inside position correctly */
.cd-matrix td, .cd-matrix th { position: relative !important; }

/* custom tooltip */
.cd-tooltip { position: absolute; z-index: 10000; background: #111; color: #fff; padding: 8px 10px; border-radius: 6px; font-size: 13px; max-width: 320px; box-shadow: 0 6px 18px rgba(0,0,0,.18); white-space: pre-wrap; }
.cd-tooltip .hd { font-weight:700; margin-bottom:4px; }

/* Floating note editor */
#cd-note-pop { position: fixed; z-index: 9999; background:#fff; border:1px solid #ddd; border-radius:10px; padding:10px;
  box-shadow: 0 8px 24px rgba(0,0,0,.12); width: 340px; max-width: calc(100vw - 24px); }
#cd-note-pop h4 { margin:0 0 6px; font-size:14px; }
#cd-note-pop textarea { width:100%; height:90px; resize:vertical; }
#cd-note-pop .actions { display:flex; gap:8px; justify-content:flex-end; margin-top:8px; }
#cd-note-pop button { padding:6px 10px; border-radius:6px; border:1px solid #ccc; background:#f7f7f7; cursor:pointer; }
#cd-note-pop button.primary { background:#5b6cff; border-color:#5b6cff; color:#fff; }
#cd-note-pop .small { color:#6b7280; font-size:12px; }

@media (max-width: 900px){ .cd-filters{ grid-template-columns:repeat(2,minmax(0,1fr)); } }
@media (max-width: 560px){ .cd-filters{ grid-template-columns:1fr; } }
